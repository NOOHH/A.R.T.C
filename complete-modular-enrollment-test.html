<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modular Enrollment - Complete Test Suite</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .test-card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-bottom: none;
        }
        
        .test-card-header h5 {
            margin: 0;
            font-weight: 600;
        }
        
        .test-card-body {
            padding: 25px;
        }
        
        .package-card {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            position: relative;
            overflow: hidden;
        }
        
        .package-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .package-card:hover::before {
            transform: scaleX(1);
        }
        
        .package-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }
        
        .package-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f2ff 100%);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
        }
        
        .package-card.selected::before {
            transform: scaleX(1);
        }
        
        .package-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .module-card {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            position: relative;
        }
        
        .module-card:hover {
            border-color: #28a745;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.15);
        }
        
        .module-card.selected {
            border-color: #28a745;
            background: linear-gradient(135deg, #f8fff8 0%, #e8f5e8 100%);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.2);
        }
        
        .step-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .step {
            display: flex;
            align-items: center;
            color: #6c757d;
            font-weight: 500;
            font-size: 14px;
        }
        
        .step.active {
            color: #667eea;
        }
        
        .step.completed {
            color: #28a745;
        }
        
        .step-number {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .step.active .step-number {
            background: #667eea;
            color: white;
            transform: scale(1.1);
        }
        
        .step.completed .step-number {
            background: #28a745;
            color: white;
        }
        
        .step-divider {
            width: 60px;
            height: 3px;
            background: #dee2e6;
            margin: 0 15px;
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .step.completed + .step-divider {
            background: #28a745;
        }
        
        .btn-test {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
            color: white;
        }
        
        .btn-success-test {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-success-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
            color: white;
        }
        
        .test-results {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
        }
        
        .test-result-item {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .test-result-item:last-child {
            border-bottom: none;
        }
        
        .badge-custom {
            font-size: 0.85rem;
            padding: 6px 12px;
            border-radius: 20px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-success {
            background: #28a745;
        }
        
        .status-warning {
            background: #ffc107;
        }
        
        .status-error {
            background: #dc3545;
        }
        
        @media (max-width: 768px) {
            .test-container {
                padding: 10px;
            }
            
            .step-indicator {
                flex-direction: column;
                gap: 10px;
            }
            
            .step-divider {
                width: 3px;
                height: 30px;
            }
            
            .package-card, .module-card {
                margin: 5px 0;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="text-center mb-4">
            <h1 class="display-4 text-primary mb-3">Modular Enrollment Test Suite</h1>
            <p class="lead text-muted">Complete functionality testing for the modular enrollment system</p>
        </div>
        
        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step active" id="step1">
                <div class="step-number">1</div>
                <span>Package Selection</span>
            </div>
            <div class="step-divider"></div>
            <div class="step" id="step2">
                <div class="step-number">2</div>
                <span>Module Selection</span>
            </div>
            <div class="step-divider"></div>
            <div class="step" id="step3">
                <div class="step-number">3</div>
                <span>Form Details</span>
            </div>
            <div class="step-divider"></div>
            <div class="step" id="step4">
                <div class="step-number">4</div>
                <span>Review & Submit</span>
            </div>
        </div>
        
        <!-- Package Selection Test -->
        <div class="test-card">
            <div class="test-card-header">
                <h5><i class="fas fa-box-open me-2"></i>Package Selection Test</h5>
            </div>
            <div class="test-card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="package-card" onclick="selectPackage(1, 'Standard Package', 99)">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h6 class="fw-bold mb-1">Standard Package</h6>
                                    <p class="text-muted mb-0">Perfect for beginners</p>
                                </div>
                                <span class="badge bg-primary badge-custom">Popular</span>
                            </div>
                            <ul class="list-unstyled mb-3">
                                <li><i class="fas fa-check text-success me-2"></i>Basic modules</li>
                                <li><i class="fas fa-check text-success me-2"></i>Email support</li>
                                <li><i class="fas fa-check text-success me-2"></i>Certificate</li>
                            </ul>
                            <div class="package-price">$99</div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="package-card" onclick="selectPackage(2, 'Premium Package', 199)">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h6 class="fw-bold mb-1">Premium Package</h6>
                                    <p class="text-muted mb-0">Advanced features included</p>
                                </div>
                                <span class="badge bg-success badge-custom">Best Value</span>
                            </div>
                            <ul class="list-unstyled mb-3">
                                <li><i class="fas fa-check text-success me-2"></i>All modules</li>
                                <li><i class="fas fa-check text-success me-2"></i>Priority support</li>
                                <li><i class="fas fa-check text-success me-2"></i>Advanced certificate</li>
                                <li><i class="fas fa-check text-success me-2"></i>1-on-1 mentoring</li>
                            </ul>
                            <div class="package-price">$199</div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="package-card" onclick="selectPackage(3, 'Enterprise Package', 299)">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h6 class="fw-bold mb-1">Enterprise Package</h6>
                                    <p class="text-muted mb-0">Full enterprise solution</p>
                                </div>
                                <span class="badge bg-warning badge-custom">Enterprise</span>
                            </div>
                            <ul class="list-unstyled mb-3">
                                <li><i class="fas fa-check text-success me-2"></i>All premium features</li>
                                <li><i class="fas fa-check text-success me-2"></i>24/7 support</li>
                                <li><i class="fas fa-check text-success me-2"></i>Custom modules</li>
                                <li><i class="fas fa-check text-success me-2"></i>Team training</li>
                            </ul>
                            <div class="package-price">$299</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Module Selection Test -->
        <div class="test-card" id="moduleSection" style="display: none;">
            <div class="test-card-header">
                <h5><i class="fas fa-puzzle-piece me-2"></i>Module Selection Test</h5>
            </div>
            <div class="test-card-body">
                <div class="row" id="moduleGrid">
                    <!-- Modules will be populated here -->
                </div>
            </div>
        </div>
        
        <!-- Form Fields Test -->
        <div class="test-card" id="formSection" style="display: none;">
            <div class="test-card-header">
                <h5><i class="fas fa-wpforms me-2"></i>Dynamic Form Test</h5>
            </div>
            <div class="test-card-body">
                <div id="dynamicForm">
                    <!-- Form fields will be populated here -->
                </div>
            </div>
        </div>
        
        <!-- Navigation Test -->
        <div class="test-card">
            <div class="test-card-header">
                <h5><i class="fas fa-arrows-alt-h me-2"></i>Navigation Test</h5>
            </div>
            <div class="test-card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <button class="btn btn-secondary" onclick="previousStep()" id="prevBtn">
                        <i class="fas fa-arrow-left me-2"></i>Previous
                    </button>
                    <div class="text-center">
                        <span class="badge bg-info badge-custom" id="currentStepBadge">Step 1 of 4</span>
                    </div>
                    <button class="btn btn-test" onclick="nextStep()" id="nextBtn">
                        Next<i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Test Results -->
        <div class="test-card">
            <div class="test-card-header">
                <h5><i class="fas fa-clipboard-check me-2"></i>Test Results</h5>
            </div>
            <div class="test-card-body">
                <div class="test-results" id="testResults">
                    <div class="test-result-item text-muted">
                        <i class="fas fa-info-circle me-2"></i>Click buttons above to test functionality...
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Reset Test -->
        <div class="text-center mt-4">
            <button class="btn btn-success-test" onclick="resetTest()">
                <i class="fas fa-redo me-2"></i>Reset Test
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentStep = 1;
        let selectedPackage = null;
        let selectedModules = [];
        let testResults = [];
        
        // Test data
        const testModules = {
            1: [ // Standard Package
                {id: 1, name: 'HTML Basics', description: 'Learn HTML fundamentals', duration: '2 weeks'},
                {id: 2, name: 'CSS Styling', description: 'Master CSS styling techniques', duration: '3 weeks'},
                {id: 3, name: 'JavaScript Intro', description: 'Introduction to JavaScript', duration: '4 weeks'}
            ],
            2: [ // Premium Package
                {id: 1, name: 'HTML Basics', description: 'Learn HTML fundamentals', duration: '2 weeks'},
                {id: 2, name: 'CSS Styling', description: 'Master CSS styling techniques', duration: '3 weeks'},
                {id: 3, name: 'JavaScript Intro', description: 'Introduction to JavaScript', duration: '4 weeks'},
                {id: 4, name: 'React Fundamentals', description: 'Build with React', duration: '5 weeks'},
                {id: 5, name: 'Node.js Backend', description: 'Server-side development', duration: '4 weeks'}
            ],
            3: [ // Enterprise Package
                {id: 1, name: 'HTML Basics', description: 'Learn HTML fundamentals', duration: '2 weeks'},
                {id: 2, name: 'CSS Styling', description: 'Master CSS styling techniques', duration: '3 weeks'},
                {id: 3, name: 'JavaScript Intro', description: 'Introduction to JavaScript', duration: '4 weeks'},
                {id: 4, name: 'React Fundamentals', description: 'Build with React', duration: '5 weeks'},
                {id: 5, name: 'Node.js Backend', description: 'Server-side development', duration: '4 weeks'},
                {id: 6, name: 'Database Design', description: 'Master database concepts', duration: '3 weeks'},
                {id: 7, name: 'DevOps & Deployment', description: 'Deploy applications', duration: '2 weeks'}
            ]
        };
        
        const testFormFields = [
            {
                field_name: 'full_name',
                field_label: 'Full Name',
                field_type: 'text',
                is_required: true
            },
            {
                field_name: 'email',
                field_label: 'Email Address',
                field_type: 'email',
                is_required: true
            },
            {
                field_name: 'phone',
                field_label: 'Phone Number',
                field_type: 'tel',
                is_required: false
            },
            {
                field_name: 'experience',
                field_label: 'Programming Experience',
                field_type: 'select',
                field_options: ['Beginner', 'Intermediate', 'Advanced'],
                is_required: true
            },
            {
                field_name: 'motivation',
                field_label: 'Why do you want to learn?',
                field_type: 'textarea',
                is_required: false
            }
        ];
        
        // Package selection test
        function selectPackage(packageId, packageName, price) {
            selectedPackage = {id: packageId, name: packageName, price: price};
            
            // Visual feedback
            document.querySelectorAll('.package-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.package-card').classList.add('selected');
            
            // Show modules section
            document.getElementById('moduleSection').style.display = 'block';
            
            // Load modules for this package
            loadTestModules(packageId);
            
            // Clear previous module selections
            selectedModules = [];
            
            // Update test results
            addTestResult(`Package selected: ${packageName} ($${price})`, 'success');
            
            // Update step indicator
            updateStepIndicator(2);
        }
        
        // Load test modules
        function loadTestModules(packageId) {
            const moduleGrid = document.getElementById('moduleGrid');
            const modules = testModules[packageId] || [];
            
            moduleGrid.innerHTML = modules.map(module => `
                <div class="col-md-6 col-lg-4">
                    <div class="module-card" onclick="selectModule(${module.id}, '${module.name}', '${module.duration}')">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h6 class="fw-bold mb-1">${module.name}</h6>
                            <span class="badge bg-success badge-custom">${module.duration}</span>
                        </div>
                        <p class="text-muted mb-0">${module.description}</p>
                    </div>
                </div>
            `).join('');
            
            addTestResult(`${modules.length} modules loaded for ${selectedPackage.name}`, 'success');
        }
        
        // Module selection test
        function selectModule(moduleId, moduleName, duration) {
            const moduleIndex = selectedModules.findIndex(m => m.id === moduleId);
            const moduleCard = event.target.closest('.module-card');
            
            if (moduleIndex > -1) {
                selectedModules.splice(moduleIndex, 1);
                moduleCard.classList.remove('selected');
                addTestResult(`Module deselected: ${moduleName}`, 'warning');
            } else {
                selectedModules.push({id: moduleId, name: moduleName, duration: duration});
                moduleCard.classList.add('selected');
                addTestResult(`Module selected: ${moduleName} (${duration})`, 'success');
            }
            
            updateModuleCount();
        }
        
        // Update module count display
        function updateModuleCount() {
            const count = selectedModules.length;
            if (count > 0) {
                addTestResult(`Total modules selected: ${count}`, 'success');
            }
        }
        
        // Generate test form
        function generateTestForm() {
            const formContainer = document.getElementById('dynamicForm');
            
            const formHtml = testFormFields.map(field => {
                const fieldId = field.field_name;
                const fieldLabel = field.field_label;
                const isRequired = field.is_required;
                const requiredHtml = isRequired ? ' <span class="text-danger">*</span>' : '';
                
                switch(field.field_type) {
                    case 'text':
                    case 'email':
                    case 'tel':
                        return `
                            <div class="form-group mb-3">
                                <label for="${fieldId}" class="form-label fw-bold">
                                    ${fieldLabel}${requiredHtml}
                                </label>
                                <input type="${field.field_type}" class="form-control" id="${fieldId}" 
                                       name="${fieldId}" ${isRequired ? 'required' : ''}>
                            </div>
                        `;
                    case 'select':
                        const options = field.field_options.map(option => 
                            `<option value="${option}">${option}</option>`
                        ).join('');
                        return `
                            <div class="form-group mb-3">
                                <label for="${fieldId}" class="form-label fw-bold">
                                    ${fieldLabel}${requiredHtml}
                                </label>
                                <select class="form-select" id="${fieldId}" name="${fieldId}" ${isRequired ? 'required' : ''}>
                                    <option value="">Select ${fieldLabel}</option>
                                    ${options}
                                </select>
                            </div>
                        `;
                    case 'textarea':
                        return `
                            <div class="form-group mb-3">
                                <label for="${fieldId}" class="form-label fw-bold">
                                    ${fieldLabel}${requiredHtml}
                                </label>
                                <textarea class="form-control" id="${fieldId}" name="${fieldId}" 
                                          rows="3" ${isRequired ? 'required' : ''}></textarea>
                            </div>
                        `;
                    default:
                        return '';
                }
            }).join('');
            
            formContainer.innerHTML = formHtml;
            addTestResult('Dynamic form generated with test fields', 'success');
        }
        
        // Step navigation
        function nextStep() {
            if (currentStep === 1 && !selectedPackage) {
                addTestResult('Please select a package first', 'error');
                return;
            }
            
            if (currentStep === 2 && selectedModules.length === 0) {
                addTestResult('Please select at least one module', 'error');
                return;
            }
            
            if (currentStep < 4) {
                currentStep++;
                updateStepIndicator(currentStep);
                updateCurrentStepBadge();
                addTestResult(`Navigated to step ${currentStep}`, 'success');
                
                // Show form on step 3
                if (currentStep === 3) {
                    document.getElementById('formSection').style.display = 'block';
                    generateTestForm();
                }
                
                // Update button text for final step
                if (currentStep === 4) {
                    document.getElementById('nextBtn').innerHTML = 'Submit <i class="fas fa-check ms-2"></i>';
                    document.getElementById('nextBtn').classList.remove('btn-test');
                    document.getElementById('nextBtn').classList.add('btn-success-test');
                }
            } else {
                // Submit form
                submitTest();
            }
        }
        
        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepIndicator(currentStep);
                updateCurrentStepBadge();
                addTestResult(`Navigated back to step ${currentStep}`, 'success');
                
                // Update button text
                if (currentStep < 4) {
                    document.getElementById('nextBtn').innerHTML = 'Next <i class="fas fa-arrow-right ms-2"></i>';
                    document.getElementById('nextBtn').classList.remove('btn-success-test');
                    document.getElementById('nextBtn').classList.add('btn-test');
                }
            }
        }
        
        // Update step indicator
        function updateStepIndicator(activeStep) {
            for (let i = 1; i <= 4; i++) {
                const step = document.getElementById(`step${i}`);
                step.classList.remove('active', 'completed');
                
                if (i < activeStep) {
                    step.classList.add('completed');
                } else if (i === activeStep) {
                    step.classList.add('active');
                }
            }
        }
        
        // Update current step badge
        function updateCurrentStepBadge() {
            document.getElementById('currentStepBadge').textContent = `Step ${currentStep} of 4`;
        }
        
        // Submit test
        function submitTest() {
            const formData = new FormData();
            
            // Add package and modules
            formData.append('package_id', selectedPackage.id);
            formData.append('modules', JSON.stringify(selectedModules));
            
            // Add form fields
            const formInputs = document.querySelectorAll('#dynamicForm input, #dynamicForm select, #dynamicForm textarea');
            formInputs.forEach(input => {
                formData.append(input.name, input.value);
            });
            
            addTestResult('Form submitted successfully!', 'success');
            addTestResult(`Package: ${selectedPackage.name} ($${selectedPackage.price})`, 'success');
            addTestResult(`Modules: ${selectedModules.length} selected`, 'success');
            addTestResult('All form validations passed', 'success');
            
            // Show completion message
            setTimeout(() => {
                addTestResult('🎉 Test completed successfully!', 'success');
            }, 500);
        }
        
        // Reset test
        function resetTest() {
            currentStep = 1;
            selectedPackage = null;
            selectedModules = [];
            testResults = [];
            
            // Reset UI
            document.querySelectorAll('.package-card, .module-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            document.getElementById('moduleSection').style.display = 'none';
            document.getElementById('formSection').style.display = 'none';
            
            updateStepIndicator(1);
            updateCurrentStepBadge();
            
            // Reset button
            document.getElementById('nextBtn').innerHTML = 'Next <i class="fas fa-arrow-right ms-2"></i>';
            document.getElementById('nextBtn').classList.remove('btn-success-test');
            document.getElementById('nextBtn').classList.add('btn-test');
            
            // Clear results
            document.getElementById('testResults').innerHTML = `
                <div class="test-result-item text-muted">
                    <i class="fas fa-info-circle me-2"></i>Click buttons above to test functionality...
                </div>
            `;
            
            addTestResult('Test reset successfully', 'success');
        }
        
        // Add test result
        function addTestResult(message, type = 'success') {
            const results = document.getElementById('testResults');
            const timestamp = new Date().toLocaleTimeString();
            
            const statusClass = type === 'success' ? 'status-success' : 
                               type === 'warning' ? 'status-warning' : 'status-error';
            
            const resultHtml = `
                <div class="test-result-item">
                    <span class="status-indicator ${statusClass}"></span>
                    <small class="text-muted">${timestamp}</small>
                    <span class="ms-2">${message}</span>
                </div>
            `;
            
            if (results.innerHTML.includes('Click buttons above')) {
                results.innerHTML = resultHtml;
            } else {
                results.innerHTML += resultHtml;
            }
            
            results.scrollTop = results.scrollHeight;
        }
        
        // Initialize test
        document.addEventListener('DOMContentLoaded', function() {
            addTestResult('Test suite loaded successfully', 'success');
            addTestResult('All CSS styles loaded', 'success');
            addTestResult('Bootstrap 5.3.3 and Font Awesome loaded', 'success');
            addTestResult('Ready to test modular enrollment functionality', 'success');
        });
    </script>
</body>
</html>
