<!DOCTYPE html>
<html>
<head>
    <title>File Upload Test</title>
    <meta name="csrf-token" content="{{ csrf_token() }}">
</head>
<body>
    <h2>Direct File Upload Test</h2>
    <form id="testFileForm" enctype="multipart/form-data">
        <input type="hidden" name="course_id" value="1">
        <input type="hidden" name="module_id" value="1">
        <input type="text" name="title" value="Test Upload" placeholder="Title">
        <textarea name="content" placeholder="Content">Test content</textarea>
        <input type="file" name="attachment" id="testFile" accept=".pdf,.doc,.docx,.ppt,.pptx">
        <button type="button" onclick="testUpload()">Test Upload</button>
    </form>

    <script>
        async function testUpload() {
            const form = document.getElementById('testFileForm');
            const formData = new FormData(form);
            
            // Debug what we're sending
            console.log('=== FORM DATA DEBUG ===');
            for (let [key, value] of formData.entries()) {
                if (value instanceof File) {
                    console.log(key + ':', {
                        name: value.name,
                        size: value.size,
                        type: value.type
                    });
                } else {
                    console.log(key + ':', value);
                }
            }
            
            try {
                const response = await fetch('/admin/courses/content/store', {
                    method: 'POST',
                    headers: {
                        'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
                    },
                    body: formData
                });
                
                const result = await response.json();
                console.log('Response:', result);
                
                if (result.success) {
                    alert('Upload successful!');
                } else {
                    alert('Upload failed: ' + (result.message || 'Unknown error'));
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Network error: ' + error.message);
            }
        }
    </script>
</body>
</html>
